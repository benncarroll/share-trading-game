var portfolioHistory=[];var cashHistory=[];var combinedHistory=[];var chartRendered=true;var chart=new CanvasJS.Chart("chartContainer",{theme:"light2",animationEnabled:false,animationDuration:1000,interactivityEnabled:true,axisY:{includeZero:false},axisX:{valueFormatString:"h:mm:ss tt"},data:[{showInLegend:true,lineColor:"black",name:"Portfolio",type:"spline",markerSize:0,dataPoints:portfolioHistory,yValueFormatString:"$########.##",xValueType:"dateTime"},{showInLegend:true,lineColor:"green",name:"Cash",type:"spline",markerSize:0,dataPoints:cashHistory,yValueFormatString:"$########.##",xValueType:"dateTime"},{showInLegend:true,lineColor:"orange",name:"PF + Cash ",type:"spline",markerSize:0,dataPoints:combinedHistory,yValueFormatString:"$########.##",xValueType:"dateTime"}],height:$("#chartContainer").height(),legend:{verticalAlign:"top",horizontalAlign:"right",dockInsidePlotArea:true},toolTip:{shared:true,animationEnabled:true,contentFormatter:function(c){ttDate=getFormattedDate(Number(c.entries[0].dataPoint.x));lines=[ttDate];var f=[];for(var b in c.entries){d=c.entries[b];f.push([d.dataSeries.name,d.dataPoint.y.toFixed(2),d.dataSeries.lineColor])}f.sort(function(g,e){return e[1]-g[1]});for(var b in f){d=f[b];lines.push("<span class='text-bold text-monospace' style='color:"+d[2]+"'>"+d[0]+"~$"+numberFormat(d[1])+"</span>")}longest=0;for(var a in lines){if(lines[a].length>longest){longest=lines[a].length}}for(var a in lines){d=lines[a];numSpaces=longest+5-d.length;if(d.length==longest){numSpaces+=1}lines[a]=lines[a].toString().replace("~",("&nbsp;".repeat(numSpaces)))}return lines.join("<br>")}}});var dataLength=90;var updateChart=function(c,b){c=c||1;b=b||false;for(var a=0;a<c;a++){pWorth=0;for(var e in stockData){if(stockData.hasOwnProperty(e)){s=stockData[e];pWorth+=Number(s.price*s.ownedQuantity)}}if(!b){xVal=Date.now()}else{xVal=Date.now()-a}portfolioHistory.push({x:xVal,y:roundToTwo(pWorth)});cashHistory.push({x:xVal,y:Number(cash)});combinedHistory.push({x:xVal,y:Number(Number(cash)+Number(pWorth))});if(c==1){if(pWorth<0){$("#portfolioWorth")[0].style.color="rgb(255,0,0)"}else{$("#portfolioWorth")[0].style.color="rgb(0, 180, 0)"}}if(c==1){if(cash<0){$("#cashAmt")[0].style.color="rgb(255,0,0)"}else{$("#cashAmt")[0].style.color="rgb(0, 180, 0)"}}}if(portfolioHistory.length>dataLength){portfolioHistory.shift()}if(cashHistory.length>dataLength){cashHistory.shift()}if(combinedHistory.length>dataLength){combinedHistory.shift()}$("#portfolioWorth").text("$"+numberFormat(pWorth));$("#cashAmt").text("$"+numberFormat(cash));chart.render()};setTimeout(function(){chartRendered=true},1000);